/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'buildlogic.java-application-conventions'
}

dependencies {
    implementation 'org.apache.commons:commons-text'
    implementation project(':utilities')
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.15.0' //adds jackson for json properties functionality
}

tasks.register("game", JavaExec){
    mainClass = "main.Main"
    classpath = sourceSets.main.runtimeClasspath
    
}

tasks.register("map", JavaExec){
    mainClass = "MapCreator.Main"
    classpath = sourceSets.main.runtimeClasspath
}


tasks.register('createTilesDirectory') {
    def tilesPath = layout.projectDirectory.dir("src/main/resources/tiles") // Safe reference
    def tilesPropertiesPath = layout.projectDirectory.dir("src/main/resources/tilesproperties")

    outputs.dir(tilesPath) // Mark as an output directory (Gradle optimization)
    outputs.dir(tilesPropertiesPath)

    doLast {
        File tilesDir = tilesPath.asFile
        File tilesPropDir = tilesPropertiesPath.asFile
        if (!tilesDir.exists()) {
            tilesDir.mkdirs()
            println "Created 'tiles' directory in resources."
        }

        if (!tilesPropDir.exists()) {
            tilesPropDir.mkdirs()
            println "Created 'tilesproperties' directory in resources."
        }

    }
}


//Ensure processResources depends on createTilesDirectory
tasks.named('processResources').configure {
    dependsOn tasks.named('createTilesDirectory')
}

application {
    // Define the main class for the application.
    mainClass = 'main.Main'   //This is the default main if no other argument is given
}
